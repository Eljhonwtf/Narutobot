const fs = require('fs');
const path = require('path');

module.exports = {
    name: 'listcmd',
    description: 'ğ’‚ğ’„ğ’„ğ’†ğ’”ğ’ ğ’‚ğ’ ğ’ğ’–Ìğ’„ğ’ğ’†ğ’ ğ’…ğ’†ğ’ ğ’”ğ’Šğ’”ğ’•ğ’†ğ’ğ’‚',
    run: async (sock, msg, body, args, isOwner) => {
        const from = msg.key.remoteJid;

        // 1. PROTOCOLO DE EXCLUSIÃ“N (MODO BESTIA)
        if (!isOwner) {
            await sock.sendMessage(from, { react: { text: "ğŸ’€", key: msg.key } });
            
            const frases = [
                "ã€ ğŸš« **ğ’‚ğ’„ğ’„ğ’†ğ’”ğ’ ğ’…ğ’†ğ’ğ’†ğ’ˆğ’‚ğ’…ğ’** ã€\n\nğ’Šğ’ğ’•ğ’†ğ’ğ’•ğ’ ğ’…ğ’† ğ’Šğ’ğ’•ğ’“ğ’–ğ’”ğ’Šğ’Ìğ’ ğ’…ğ’†ğ’•ğ’†ğ’„ğ’•ğ’‚ğ’…ğ’. ğ’ğ’ğ’” ğ’”ğ’†ğ’„ğ’“ğ’†ğ’•ğ’ğ’” ğ’…ğ’†ğ’ ğ’ğ’–Ìğ’„ğ’ğ’†ğ’ ğ’”ğ’ğ’ğ’ ğ’”ğ’ğ’ ğ’‘ğ’‚ğ’“ğ’‚ ğ’‹ğ’‰ğ’ğ’. ğŸš€",
                "ã€ âš ï¸ **ğ’‚ğ’ğ’†ğ’“ğ’•ğ’‚ ğ’…ğ’† ğ’”ğ’†ğ’ˆğ’–ğ’“ğ’Šğ’…ğ’‚ğ’…** ã€\n\nÂ¿ğ’’ğ’–ğ’Šğ’†ğ’“ğ’†ğ’” ğ’—ğ’†ğ’“ ğ’ğ’Šğ’” ğ’•ğ’“ğ’Šğ’‘ğ’‚ğ’”? ğ’”ğ’ğ’ğ’ ğ’†ğ’ ğ’‹ğ’†ğ’‡ğ’† ğ’•ğ’Šğ’†ğ’ğ’† ğ’†ğ’ ğ’ƒğ’Šğ’”ğ’•ğ’–ğ’“ğ’ŠÌ. ğ’‚ ğ’…ğ’ğ’“ğ’ğ’Šğ’“. ğŸŒğŸ½â€â™‚ï¸",
                "ã€ ğŸ§  **ğ’†ğ’“ğ’“ğ’ğ’“ ğ’…ğ’† ğ’ğ’Šğ’—ğ’†ğ’** ã€\n\nğ’ğ’ ğ’•ğ’Šğ’†ğ’ğ’†ğ’” ğ’ğ’‚ğ’” ğ’ğ’†ğ’–ğ’“ğ’ğ’ğ’‚ğ’” ğ’ğ’†ğ’„ğ’†ğ’”ğ’‚ğ’“ğ’Šğ’‚ğ’” ğ’‘ğ’‚ğ’“ğ’‚ ğ’†ğ’ğ’•ğ’†ğ’ğ’…ğ’†ğ’“ ğ’†ğ’”ğ’•ğ’† ğ’„ğ’Ìğ’…ğ’Šğ’ˆğ’. ğ’™",
                "ã€ ğŸ¥· **ğ’”ğ’šğ’”ğ’•ğ’†ğ’ ğ’ƒğ’ğ’ğ’„ğ’Œ** ã€\n\nğ’–ğ’ ğ’„ğ’Šğ’—ğ’Šğ’ ğ’Šğ’ğ’•ğ’†ğ’ğ’•ğ’‚ğ’ğ’…ğ’ ğ’‰ğ’‚ğ’„ğ’Œğ’†ğ’‚ğ’“ ğ’ğ’‚ ğ’‚ğ’ğ’…ğ’†ğ’‚. ğ’‘ğ’“ğ’ğ’„ğ’†ğ’”ğ’ ğ’‚ğ’ƒğ’ğ’“ğ’•ğ’‚ğ’…ğ’. ğŸ’€"
            ];
            const randomFrase = frases[Math.floor(Math.random() * frases.length)];
            
            return await sock.sendMessage(from, { text: randomFrase }, { quoted: msg });
        }

        // 2. DESPLIEGUE DEL NÃšCLEO (SOLO PARA EL JEFE)
        try {
            const dirPath = path.join(__dirname); 
            const archivos = fs.readdirSync(dirPath).filter(file => file.endsWith('.js'));
            
            await sock.sendMessage(from, { react: { text: "âš¡", key: msg.key } });

            // --- DISEÃ‘O: INTERFAZ DE COMANDOS MODO BESTIA ---
            let lista = `ã€ ğŸš€ **ğ’ğ’‚ğ’“ğ’–ğ’•ğ’ğ’ƒğ’ğ’• ğ’„ğ’ğ’ğ’ğ’‚ğ’ğ’… ğ’„ğ’†ğ’ğ’•ğ’†ğ’“** ğŸŒğŸ½â€â™‚ï¸ ã€\n\n`;
            
            lista += `â”Œâ”€â”€ã€ ğŸ“Š **ğ’”ğ’šğ’”ğ’•ğ’†ğ’ ğ’”ğ’•ğ’‚ğ’•ğ’”** ã€\n`;
            lista += `â”‚ ğŸ“‚ **ğ’•ğ’ğ’•ğ’‚ğ’ ğ’„ğ’ğ’…ğ’”:** ${archivos.length}\n`;
            lista += `â”‚ âš¡ **ğ’†ğ’”ğ’•ğ’‚ğ’…ğ’:** ğ’ğ’–Ìğ’„ğ’ğ’†ğ’ ğ’ğ’‘ğ’†ğ’“ğ’‚ğ’•ğ’Šğ’—ğ’\n`;
            lista += `â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\n`;

            lista += `â”Œâ”€â”€ã€ ğŸ› ï¸ **ğ’Šğ’ğ’—ğ’†ğ’ğ’•ğ’‚ğ’“ğ’Šğ’ ğ’…ğ’† ğ’‚ğ’“ğ’ğ’‚ğ’”** ã€\n`;
            
            archivos.forEach((file, index) => {
                const nombreCmd = file.replace('.js', '');
                // Formato de lista tÃ©cnica
                lista += `â”‚ [${index + 1}] â”€â”€> /${nombreCmd}\n`;
            });

            lista += `â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\n`;
            lista += `ğŸš€ **ğ’”ğ’•ğ’‚ğ’•ğ’–ğ’”:** ğ’•ğ’ğ’…ğ’ğ’” ğ’ğ’ğ’” ğ’”ğ’šğ’”ğ’•ğ’†ğ’ğ’‚ğ’” ğ’ğ’ğ’ğ’Šğ’ğ’†.\n`;
            lista += `ğŸŒğŸ½â€â™‚ï¸ _ğ’”ğ’šğ’”ğ’•ğ’†ğ’ ğ’ƒğ’š ğ’‹ğ’‰ğ’ğ’ ğ’”ğ’šğ’”ğ’•ğ’†ğ’_`;

            await sock.sendMessage(from, { 
                text: lista,
                contextInfo: {
                    externalAdReply: {
                        title: "ğŸ“‚ ğ’ğ’–Ìğ’„ğ’ğ’†ğ’ ğ’…ğ’† ğ’‚ğ’“ğ’„ğ’‰ğ’Šğ’—ğ’ğ’” ğ’‚ğ’„ğ’•ğ’Šğ’—ğ’",
                        body: `${archivos.length} ğ’ğ’Ìğ’…ğ’–ğ’ğ’ğ’” ğ’…ğ’†ğ’•ğ’†ğ’„ğ’•ğ’‚ğ’…ğ’ğ’” ğŸš€`,
                        mediaType: 1,
                        showAdAttribution: true,
                        renderLargerThumbnail: false
                    }
                }
            }, { quoted: msg });

        } catch (err) {
            console.log("Error en listcmd:", err);
            await sock.sendMessage(from, { 
                text: "ã€ âŒ **ğ’„ğ’“ğ’Šğ’•ğ’Šğ’„ğ’‚ğ’ ğ’†ğ’“ğ’“ğ’ğ’“** ã€\n\nğ’‡ğ’‚ğ’ğ’ğ’ ğ’‚ğ’ ğ’ğ’†ğ’†ğ’“ ğ’†ğ’ ğ’…ğ’Šğ’“ğ’†ğ’„ğ’•ğ’ğ’“ğ’Šğ’ ğ’…ğ’† ğ’„ğ’ğ’ğ’‚ğ’ğ’…ğ’ğ’”. ğŸš€" 
            });
        }
    }
};
